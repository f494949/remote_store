<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Vue</title>
    <script src="https://cdn.staticfile.org/vue/3.2.36/vue.global.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <style>
      /* .box2 {
        margin-top: 10px;
      }
      .total .wrapper {
        margin-right: 80px;
        color: #999;
        margin-top: 5px;
        opacity: 0;
        transition: all 0.5s;
      }
      .wrapper button {
        background: #00aeec;
        color: #fff;
        border: none;
        border-radius: 4px;
        margin-left: 10px;
        width: 70px;
        cursor: pointer;
      }
      .wrapper input:focus {
        border-color: #e4e4e4;
        background: #fff;
        height: 50px;
      }
    </style>
  </head>
  <body>
    <div id="hello-vue" class="demo">{{ message }}</div>

    <div class="wrapper">
      <input type="text" class="get" placeholder="请输入内容" maxlength="200" />
      <button @click="getMessage">发送</button>
    </div>
    <div>
      <span class="total">0/200字</span>
    </div>
    <div class="list">
      <div class="item" style="display: none">
        <i class="avatar"></i>
        <div>
          <p class="name">syf</p>
          <p class="text">你们好</p>
          <p class="time">2023-3-14 13:00:00</p>
        </div>
      </div>
    </div>

    <ul id="todoapp">
      <li v-for="(item,index) in arr">{{item.content}}</li>
    </ul> */

    <script>
      // axios配置
      axios.defaults.timeout = 5000 // 响应时间
      axios.defaults.headers.post['Content-Type'] =
        'application/x-www-form-urlencoded;charset=UTF-8' // 配置post请求头
      axios.defaults.headers.get['Content-Type'] =
        'application/json;charset=UTF-8' // 配置get请求头
      axios.defaults.baseURL = 'http://localhost:8000' // 配置接口地址
      // POST传参序列化(添加请求拦截器)
      axios.interceptors.request.use(
        (config) => {
          // 在发送请求之前做某件事
          if (config.method === 'post') {
            // 这里使用qs对数据进行处理，防止后台$_POST接收不到
            config.data = qs.stringify(config.data)
          }
          return config
        },
        (error) => {
          console.log('错误的传参', 'fail')
          return Promise.reject(error)
        }
      )

      const HelloVueApp = {
        data() {
          return {
            message: 'Hello Vue!!',
          }
        },
      }

      const inp = document.querySelector('input')
      const total = document.querySelector('.total')
      const item = document.querySelector('.item')
      const text = document.querySelector('.text')

      inp.addEventListener('focus', () => {
        total.style.opacity = 1
      })
      inp.addEventListener('blur', () => {
        total.style.opacity = 0
      })
      inp.addEventListener('input', () => {
        total.innerHTML = `${inp.value.length}/200字`
      })

      inp.addEventListener('keyup', (e) => {
        if (e.key === 'Enter') {
          if (inp.value.trim()) {
            item.style.display = 'block'
            text.innerHTML = inp.value
          }
          inp.value = ''
        }
      })

      let params = {
        name: 'luMaster',
        son: [
          {
            proName: '电路板',
            index: 0,
          },
          {
            proName: '电源',
            index: 1,
          },
        ],
      }
      this.$http
        .post('/index.php', params)
        .then(
          (response) => {
            console.log(response)
          },
          (err) => {
            console.log(err)
          }
        )
        .catch((error) => {
          console.log(error)
        })

      // const xmlhttp = new XMLHttpRequest()
      // xmlhttp.open("GET", "www.test.com/learn_vue/learn.php")
      // xmlhttp.send()
      // xmlhttp.onreadystatechange = function() {
      //   if(xmlhttp.readyState == 4 && xmlhttp.status == 200) {
      //     console.log(this.responseText)
      //   }
      // }

      // function item(option) {
      //   const xhr = new XMLHttpRequest
      //   const qs = resolveData(option.data)

      //   if (option.method.toUpperCase === 'GET') {
      //     xhr.open(option.method,option.url + '?' + qs)
      //     xhr.send()
      //   }else if(option.method.toUpperCase === 'POST') {
      //     xhr.open(option.method, option.url)
      //     xhr.setRequestHeader('')
      //     xhr.send(qs)
      //   }
      // }

      // const vm = new Vue({
      //   submitContend() {
      //   const tx = document.querySelector('el-input')
      //   const chat = document.querySelector('#chatRecord')
      //   const btn = document.querySelector('el-button')
      //   chat.addEventListener('click', e => {
      //     if (e.value === btn.value) {
      //       if (tx.value.trim() !== '') {
      //         this.textarea = tx.value
      //       }
      //       this.textarea = ''
      //     }
      //   })
      //   this.$refs.input.focus()
      //   }
      // })

      Vue.createApp(HelloVueApp).mount('#hello-vue')
    </script>
  </body>
</html>
